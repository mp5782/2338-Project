abline( v=40, col="firebrick", lty=2 )
text( 42, 45000, "Phase 2 lockdown", col="firebrick", cex=0.7, pos=4,srt=90 )
abline( v=59, col="firebrick", lty=2 )
text( 61, 50000, "Phase 3 lockdown", col="firebrick", cex=0.7, pos=4 ,srt=90)
abline( v=73, col="firebrick", lty=2 )
text( 75, 55000, "Phase 4 lockdown", col="firebrick", cex=0.7, pos=4 ,srt=90)
abline( v=87, col='firebrick', lty=2)
text( 89, 60000, "Unlock 1", col="firebrick", cex=0.7, pos=4 ,srt=90)
abline( v=117, col='firebrick', lty=2)
text( 119, 60000, "Unlock 2", col="firebrick", cex=0.7, pos=4 ,srt=90)
abline( v=148, col='firebrick', lty=2)
ts <- lm(confirmed_infections ~ nointer_indi+phase_indi_0 + phase_indi_1 +phase_indi_2+phase_indi_3 +phase_indi_4 + phase_indi_5 +days+
+ days1 + days2 + days3 +days4 + days5 + days6 , data=d)
ts_b <- lm(confirmed_infections ~ nointer_indi_before + phase_indi_before_0  + phase_indi_before_1 +phase_indi_before_2 + phase_indi_before_3 +phase_indi_before_4  + phase_indi_before_5  +days_before0  + days_before1 + days_before2 + days_before3  +days_before4 + days_before5 + days_before6 , data=d)
ts_a <- lm(confirmed_infections ~ nointer_indi_after + phase_indi_after_0  + phase_indi_after_1 +phase_indi_after_2 + phase_indi_after_3 +phase_indi_after_4  + phase_indi_after_5  +days_after0  + days_after1 + days_after2 + days_after3  +days_after4 + days_after5 + days_after6 , data=d)
#lines( d$days, ts_b$fitted.values, col="blue", lwd=2 )
#lines( d$days, ts_a$fitted.values, col="green", lwd=2 )
#polygon(c(d$days,rev(d$days)),c(ts_b$fitted.values,rev(ts_a$fitted.values)), col=rgb(0.5, 0, 0,0.2))
lines( d$days, ts$fitted.values, col="red", lwd=2 )
axis(1, at=d$days,labels=d$date, col.axis="red", las=2,cex.axis = 0.5)
dev.off()
}
#case growth
data_1 <- read.csv("./data/aggregate_case_05_04.csv")
data_1 <- unique(data_1)
data_1 <- dummy_cols(data_1, select_columns = c('phase_indi', 'phase_indi_before','phase_indi_after'))
data_1 <- rename(data_1,c('nointer_indi'='phase_indi_-1'))
data_1 <- rename(data_1,c('nointer_indi_before'='phase_indi_before_-1'))
data_1 <- rename(data_1,c('nointer_indi_after'='phase_indi_after_-1'))
data_2 <- subset(data_1,state!='India')
lmer_case_growth <- lmer(case_growth ~ nointer_indi+phase_indi_0 + phase_indi_1 +phase_indi_2+phase_indi_3 +phase_indi_4 + phase_indi_5 +days+
+ days1 + days2 + days3 +days4 + days5 + days6 + (1| state), data = data_2)
summary(lmer_case_growth)
data <- NULL
data$case_growth <- data_1$case_growth
data$state <- as.factor(data_1$state)
data$days <- data_1$days
data <- data.frame(data)
states = unique(data$state)
for (s in states){
d <- subset(data_1,state%in%c(s))
pdf(paste("case_growth_",s,".pdf"))
d[is.na(d)] <- 0
plot( d$days, d$case_growth,
bty="n", pch=19, col="gray",
xlab = "Date",
ylab = "Case Growth",main=s,xaxt='n'
)
abline( v=19, col="firebrick", lty=2 )
text( 24, 40000, "Phase 1 lockdown", col="firebrick", cex=0.7, pos=4 )
abline( v=40, col="firebrick", lty=2 )
text( 42, 45000, "Phase 2 lockdown", col="firebrick", cex=0.7, pos=4 )
abline( v=59, col="firebrick", lty=2 )
text( 61, 50000, "Phase 3 lockdown", col="firebrick", cex=0.7, pos=4 )
abline( v=73, col="firebrick", lty=2 )
text( 75, 55000, "Phase 4 lockdown", col="firebrick", cex=0.7, pos=4 )
abline( v=87, col='firebrick', lty=2)
text( 89, 60000, "Unlock 1", col="firebrick", cex=0.7, pos=4 )
abline( v=117, col='firebrick', lty=2)
text( 119, 60000, "Unlock 2", col="firebrick", cex=0.7, pos=4 )
abline( v=148, col='firebrick', lty=2)
ts <- lm(case_growth ~ nointer_indi+phase_indi_0 + phase_indi_1 +phase_indi_2+phase_indi_3 +phase_indi_4 + phase_indi_5 +days+
+ days1 + days2 + days3 +days4 + days5 + days6 , data=d)
ts_b <- lm(case_growth ~ nointer_indi_before + phase_indi_before_0  + phase_indi_before_1 +phase_indi_before_2 + phase_indi_before_3 +phase_indi_before_4  + phase_indi_before_5  +days_before0  + days_before1 + days_before2 + days_before3  +days_before4 + days_before5 + days_before6 , data=d)
ts_a <- lm(case_growth ~ nointer_indi_after + phase_indi_after_0  + phase_indi_after_1 +phase_indi_after_2 + phase_indi_after_3 +phase_indi_after_4  + phase_indi_after_5  +days_after0  + days_after1 + days_after2 + days_after3  +days_after4 + days_after5 + days_after6 , data=d)
#lines( d$days, ts_b$fitted.values, col="blue", lwd=2 )
#lines( d$days, ts_a$fitted.values, col="green", lwd=2 )
polygon(c(d$days,rev(d$days)),c(ts_b$fitted.values,rev(ts_a$fitted.values)), col=rgb(1, 0, 0,0.2))
lines( d$days, ts$fitted.values, col="red", lwd=2 )
axis(1, at=d$days,labels=d$date, col.axis="red", las=2,cex.axis = 0.5)
dev.off()
}
#data_1 <- read.csv("../data/aggregate/final/aggregate_mobility_05_04.csv")
#data_2 <- subset(data_1,state!='India')
data_1 <- read.csv("./data/aggregate_mobility_05_04.csv")
data_1 <- unique(data_1)
data_1 <- dummy_cols(data_1, select_columns = c('phase_indi', 'phase_indi_before','phase_indi_after'))
data_1 <- rename(data_1,c('nointer_indi'='phase_indi_-1'))
data_1 <- rename(data_1,c('nointer_indi_before'='phase_indi_before_-1'))
data_1 <- rename(data_1,c('nointer_indi_after'='phase_indi_after_-1'))
data_2 <- subset(data_1,state!='India')
lmer_mobility <- lmer(Mobility ~ nointer_indi+phase_indi_0 + phase_indi_1 +phase_indi_2+phase_indi_3 +phase_indi_4 + phase_indi_5 +days+
+ days1 + days2 + days3 +days4 + days5 + days6 + (1| state), data = data_2)
summary(lmer_mobility)
data <- NULL
data$case_growth <- data_1$Mobility
data$state <- as.factor(data_1$state)
data$days <- data_1$days
data <- data.frame(data)
states = unique(data$state)
for (s in states){
d <- subset(data_1,state%in%c(s))
d[is.na(d)] <- 0
pdf(paste("./Results/mobility_",s,".pdf"))
plot( d$days, d$Mobility,
bty="n", pch=19, col="gray",
xlab = "Date",
ylab = "Mobility",main=s,xaxt='n'
)
abline( v=12, col="firebrick", lty=2 )
text( 24, 40000, "Phase 1 lockdown", col="firebrick", cex=0.7, pos=4 )
abline( v=33, col="firebrick", lty=2 )
text( 42, 45000, "Phase 2 lockdown", col="firebrick", cex=0.7, pos=4 )
abline( v=52, col="firebrick", lty=2 )
text( 61, 50000, "Phase 3 lockdown", col="firebrick", cex=0.7, pos=4 )
abline( v=66, col="firebrick", lty=2 )
text( 75, 55000, "Phase 4 lockdown", col="firebrick", cex=0.7, pos=4 )
abline( v=80, col='firebrick', lty=2)
text( 89, 60000, "Unlock 1", col="firebrick", cex=0.7, pos=4 )
abline( v=110, col='firebrick', lty=2)
text( 119, 60000, "Unlock 2", col="firebrick", cex=0.7, pos=4 )
abline( v=141, col='firebrick', lty=2)
ts_mobility <- lm(Mobility~ nointer_indi+phase_indi_0 + phase_indi_1 +phase_indi_2+phase_indi_3 +phase_indi_4 + phase_indi_5 +days + days1 + days2 + days3 +days4 + days5 + days6 , data=d)
ts_a <- lm(Mobility ~ nointer_indi_after + phase_indi_after_0  + phase_indi_after_1 +phase_indi_after_2 + phase_indi_after_3 +phase_indi_after_4  + phase_indi_after_5  +days_after0  + days_after1 + days_after2 + days_after3  +days_after4 + days_after5 + days_after6 , data=d)
ts_b <- lm(Mobility ~ nointer_indi_before + phase_indi_before_0  + phase_indi_before_1 +phase_indi_before_2 + phase_indi_before_3 +phase_indi_before_4  + phase_indi_before_5  +days_before0  + days_before1 + days_before2 + days_before3  +days_before4 + days_before5 + days_before6 , data=d)
#lines( d$days, ts_b$fitted.values, col="blue", lwd=2 )
#lines( d$days, ts_a$fitted.values, col="green", lwd=2 )
polygon(c(d$days,rev(d$days)),c(ts_b$fitted.values,rev(ts_a$fitted.values)), col=rgb(1, 0, 0,0.2))
lines( d$days, ts_mobility$fitted.values, col="red", lwd=2 )
axis(1, at=d$days,labels=d$date, col.axis="red", las=2,cex.axis = 0.5)
dev.off()
}
#data_1 <- read.csv("../data/aggregate/final/aggregate_mobility_05_04.csv")
#data_2 <- subset(data_1,state!='India')
data_1 <- read.csv("./data/aggregate_mobility_05_04.csv")
data_1 <- unique(data_1)
data_1 <- dummy_cols(data_1, select_columns = c('phase_indi', 'phase_indi_before','phase_indi_after'))
data_1 <- rename(data_1,c('nointer_indi'='phase_indi_-1'))
data_1 <- rename(data_1,c('nointer_indi_before'='phase_indi_before_-1'))
data_1 <- rename(data_1,c('nointer_indi_after'='phase_indi_after_-1'))
data_2 <- subset(data_1,state!='India')
lmer_mobility <- lmer(Mobility ~ nointer_indi+phase_indi_0 + phase_indi_1 +phase_indi_2+phase_indi_3 +phase_indi_4 + phase_indi_5 +days+
+ days1 + days2 + days3 +days4 + days5 + days6 + (1| state), data = data_2)
summary(lmer_mobility)
data <- NULL
data$case_growth <- data_1$Mobility
data$state <- as.factor(data_1$state)
data$days <- data_1$days
data <- data.frame(data)
states = unique(data$state)
for (s in states){
d <- subset(data_1,state%in%c(s))
d[is.na(d)] <- 0
pdf(paste("./Results/mobility_",s,".pdf"))
plot( d$days, d$Mobility,
bty="n", pch=19, col="gray",
xlab = "Date",
ylab = "Mobility",main=s,xaxt='n'
)
abline( v=12, col="firebrick", lty=2 )
text( 24, 40000, "Phase 1 lockdown", col="firebrick", cex=0.7, pos=4 )
abline( v=33, col="firebrick", lty=2 )
text( 42, 45000, "Phase 2 lockdown", col="firebrick", cex=0.7, pos=4 )
abline( v=52, col="firebrick", lty=2 )
text( 61, 50000, "Phase 3 lockdown", col="firebrick", cex=0.7, pos=4 )
abline( v=66, col="firebrick", lty=2 )
text( 75, 55000, "Phase 4 lockdown", col="firebrick", cex=0.7, pos=4 )
abline( v=80, col='firebrick', lty=2)
text( 89, 60000, "Unlock 1", col="firebrick", cex=0.7, pos=4 )
abline( v=110, col='firebrick', lty=2)
text( 119, 60000, "Unlock 2", col="firebrick", cex=0.7, pos=4 )
abline( v=141, col='firebrick', lty=2)
ts_mobility <- lm(Mobility~ nointer_indi+phase_indi_0 + phase_indi_1 +phase_indi_2+phase_indi_3 +phase_indi_4 + phase_indi_5 +days + days1 + days2 + days3 +days4 + days5 + days6 , data=d)
ts_a <- lm(Mobility ~ nointer_indi_after + phase_indi_after_0  + phase_indi_after_1 +phase_indi_after_2 + phase_indi_after_3 +phase_indi_after_4  + phase_indi_after_5  +days_after0  + days_after1 + days_after2 + days_after3  +days_after4 + days_after5 + days_after6 , data=d)
ts_b <- lm(Mobility ~ nointer_indi_before + phase_indi_before_0  + phase_indi_before_1 +phase_indi_before_2 + phase_indi_before_3 +phase_indi_before_4  + phase_indi_before_5  +days_before0  + days_before1 + days_before2 + days_before3  +days_before4 + days_before5 + days_before6 , data=d)
#lines( d$days, ts_b$fitted.values, col="blue", lwd=2 )
#lines( d$days, ts_a$fitted.values, col="green", lwd=2 )
#polygon(c(d$days,rev(d$days)),c(ts_b$fitted.values,rev(ts_a$fitted.values)), col=rgb(1, 0, 0,0.2))
lines( d$days, ts_mobility$fitted.values, col="red", lwd=2 )
axis(1, at=d$days,labels=d$date, col.axis="red", las=2,cex.axis = 0.5)
dev.off()
}
knitr::opts_chunk$set(echo = TRUE)
library(lme4)
library(lattice)
library(fastDummies)
library(tidyverse)
data_1 <- read.csv("./data/aggregate_case_05_04.csv")
data_1 <- unique(data_1)
data_1 <- dummy_cols(data_1, select_columns = c('phase_indi', 'phase_indi_before','phase_indi_after'))
data_1 <- rename(data_1,c('nointer_indi'='phase_indi_-1'))
data_1 <- rename(data_1,c('nointer_indi_before'='phase_indi_before_-1'))
data_1 <- read.csv("./data/aggregate_case_05_04.csv")
data_1 <- unique(data_1)
data_1 <- dummy_cols(data_1, select_columns = c('phase_indi'))
data_1 <- rename(data_1,c('nointer_indi'='phase_indi_-1'))
data_2 <- subset(data_1,state!='India')
lmer_rt<- lmer(confirmed_infections~ nointer_indi+phase_indi_0 + phase_indi_1 +phase_indi_2+phase_indi_3 +phase_indi_4 + phase_indi_5 +days+
+ days1 + days2 + days3 +days4 + days5 + days6 + (1| state), data = data_2)
summary(lmer_rt)
data <- NULL
data$case_growth <- data_1$confirmed_infections
data$state <- as.factor(data_1$state)
data$days <- data_1$days
data <- data.frame(data)
states = unique(data$state)
for (s in states){
d <- subset(data_1,state%in%c(s))
d[is.na(d)] <- 0
pdf(paste("./Results/confirmed_infections_",s,".pdf"))
plot( d$days, d$confirmed_infections,
bty="n", pch=19, col="gray",
xlab = "Date",
ylab = "Confirmed Infections",main=s,xaxt='n'
)
abline( v=19, col="firebrick", lty=2 )
text( 24, 40000, "Phase 1 lockdown", col="firebrick", cex=0.7, pos=4,srt=90 )
abline( v=40, col="firebrick", lty=2 )
text( 42, 45000, "Phase 2 lockdown", col="firebrick", cex=0.7, pos=4,srt=90 )
abline( v=59, col="firebrick", lty=2 )
text( 61, 50000, "Phase 3 lockdown", col="firebrick", cex=0.7, pos=4 ,srt=90)
abline( v=73, col="firebrick", lty=2 )
text( 75, 55000, "Phase 4 lockdown", col="firebrick", cex=0.7, pos=4 ,srt=90)
abline( v=87, col='firebrick', lty=2)
text( 89, 60000, "Unlock 1", col="firebrick", cex=0.7, pos=4 ,srt=90)
abline( v=117, col='firebrick', lty=2)
text( 119, 60000, "Unlock 2", col="firebrick", cex=0.7, pos=4 ,srt=90)
abline( v=148, col='firebrick', lty=2)
ts <- lm(confirmed_infections ~ nointer_indi+phase_indi_0 + phase_indi_1 +phase_indi_2+phase_indi_3 +phase_indi_4 + phase_indi_5 +days+
+ days1 + days2 + days3 +days4 + days5 + days6 , data=d)
ts_b <- lm(confirmed_infections ~ nointer_indi_before + phase_indi_before_0  + phase_indi_before_1 +phase_indi_before_2 + phase_indi_before_3 +phase_indi_before_4  + phase_indi_before_5  +days_before0  + days_before1 + days_before2 + days_before3  +days_before4 + days_before5 + days_before6 , data=d)
ts_a <- lm(confirmed_infections ~ nointer_indi_after + phase_indi_after_0  + phase_indi_after_1 +phase_indi_after_2 + phase_indi_after_3 +phase_indi_after_4  + phase_indi_after_5  +days_after0  + days_after1 + days_after2 + days_after3  +days_after4 + days_after5 + days_after6 , data=d)
#lines( d$days, ts_b$fitted.values, col="blue", lwd=2 )
#lines( d$days, ts_a$fitted.values, col="green", lwd=2 )
#polygon(c(d$days,rev(d$days)),c(ts_b$fitted.values,rev(ts_a$fitted.values)), col=rgb(0.5, 0, 0,0.2))
lines( d$days, ts$fitted.values, col="red", lwd=2 )
axis(1, at=d$days,labels=d$date, col.axis="red", las=2,cex.axis = 0.5)
dev.off()
}
data_1 <- read.csv("./data/aggregate_case_05_04.csv")
data_1 <- unique(data_1)
data_1 <- dummy_cols(data_1, select_columns = c('phase_indi'))
data_1 <- rename(data_1,c('nointer_indi'='phase_indi_-1'))
data_2 <- subset(data_1,state!='India')
lmer_rt<- lmer(confirmed_infections~ nointer_indi+phase_indi_0 + phase_indi_1 +phase_indi_2+phase_indi_3 +phase_indi_4 + phase_indi_5 +days+
+ days1 + days2 + days3 +days4 + days5 + days6 + (1| state), data = data_2)
summary(lmer_rt)
data <- NULL
data$case_growth <- data_1$confirmed_infections
data$state <- as.factor(data_1$state)
data$days <- data_1$days
data <- data.frame(data)
states = unique(data$state)
for (s in states){
d <- subset(data_1,state%in%c(s))
d[is.na(d)] <- 0
pdf(paste("./Results/confirmed_infections_",s,".pdf"))
plot( d$days, d$confirmed_infections,
bty="n", pch=19, col="gray",
xlab = "Date",
ylab = "Confirmed Infections",main=s,xaxt='n'
)
abline( v=19, col="firebrick", lty=2 )
text( 24, 40000, "Phase 1 lockdown", col="firebrick", cex=0.7, pos=4,srt=90 )
abline( v=40, col="firebrick", lty=2 )
text( 42, 45000, "Phase 2 lockdown", col="firebrick", cex=0.7, pos=4,srt=90 )
abline( v=59, col="firebrick", lty=2 )
text( 61, 50000, "Phase 3 lockdown", col="firebrick", cex=0.7, pos=4 ,srt=90)
abline( v=73, col="firebrick", lty=2 )
text( 75, 55000, "Phase 4 lockdown", col="firebrick", cex=0.7, pos=4 ,srt=90)
abline( v=87, col='firebrick', lty=2)
text( 89, 60000, "Unlock 1", col="firebrick", cex=0.7, pos=4 ,srt=90)
abline( v=117, col='firebrick', lty=2)
text( 119, 60000, "Unlock 2", col="firebrick", cex=0.7, pos=4 ,srt=90)
abline( v=148, col='firebrick', lty=2)
ts <- lm(confirmed_infections ~ nointer_indi+phase_indi_0 + phase_indi_1 +phase_indi_2+phase_indi_3 +phase_indi_4 + phase_indi_5 +days+
+ days1 + days2 + days3 +days4 + days5 + days6 , data=d)
lines( d$days, ts$fitted.values, col="red", lwd=2 )
axis(1, at=d$days,labels=d$date, col.axis="red", las=2,cex.axis = 0.5)
dev.off()
}
data_1 <- read.csv("./data/aggregate_mobility_05_04.csv")
data_1 <- unique(data_1)
data_1 <- dummy_cols(data_1, select_columns = c('phase_indi'))
data_1 <- rename(data_1,c('nointer_indi'='phase_indi_-1'))
data_2 <- subset(data_1,state!='India')
lmer_mobility <- lmer(Mobility ~ nointer_indi+phase_indi_0 + phase_indi_1 +phase_indi_2+phase_indi_3 +phase_indi_4 + phase_indi_5 +days+
+ days1 + days2 + days3 +days4 + days5 + days6 + (1| state), data = data_2)
summary(lmer_mobility)
data <- NULL
data$case_growth <- data_1$Mobility
data$state <- as.factor(data_1$state)
data$days <- data_1$days
data <- data.frame(data)
states = unique(data$state)
for (s in states){
d <- subset(data_1,state%in%c(s))
d[is.na(d)] <- 0
pdf(paste("./Results/mobility_",s,".pdf"))
plot( d$days, d$Mobility,
bty="n", pch=19, col="gray",
xlab = "Date",
ylab = "Mobility",main=s,xaxt='n'
)
abline( v=12, col="firebrick", lty=2 )
text( 24, 40000, "Phase 1 lockdown", col="firebrick", cex=0.7, pos=4 )
abline( v=33, col="firebrick", lty=2 )
text( 42, 45000, "Phase 2 lockdown", col="firebrick", cex=0.7, pos=4 )
abline( v=52, col="firebrick", lty=2 )
text( 61, 50000, "Phase 3 lockdown", col="firebrick", cex=0.7, pos=4 )
abline( v=66, col="firebrick", lty=2 )
text( 75, 55000, "Phase 4 lockdown", col="firebrick", cex=0.7, pos=4 )
abline( v=80, col='firebrick', lty=2)
text( 89, 60000, "Unlock 1", col="firebrick", cex=0.7, pos=4 )
abline( v=110, col='firebrick', lty=2)
text( 119, 60000, "Unlock 2", col="firebrick", cex=0.7, pos=4 )
abline( v=141, col='firebrick', lty=2)
ts_mobility <- lm(Mobility~ nointer_indi+phase_indi_0 + phase_indi_1 +phase_indi_2+phase_indi_3 +phase_indi_4 + phase_indi_5 +days + days1 + days2 + days3 +days4 + days5 + days6 , data=d)
lines( d$days, ts_mobility$fitted.values, col="red", lwd=2 )
axis(1, at=d$days,labels=d$date, col.axis="red", las=2,cex.axis = 0.5)
dev.off()
}
#load libraries
library(MASS)
library(tidyverse)
library(e1071)
library(tree)
library(gbm)
#LOAD DATA
df.mob <- read_csv("https://raw.githubusercontent.com/mp5782/2338-Project/main/data/mobility_class.csv")
mob_smp <- floor(0.75 * nrow(df.mob))
df.case <- read_csv("https://raw.githubusercontent.com/mp5782/2338-Project/main/data/infection_class.csv")
case_smp <- floor(0.75 * nrow(df.case))
## mobility data split
set.seed(123)
train_ind1 <- sample(seq_len(nrow(df.mob)), size = mob_smp)
mobtrain <- df.mob[train_ind1, ]
mobtest <- df.mob[-train_ind1, ]
## case data split
set.seed(123)
train_ind2 <- sample(seq_len(nrow(df.case)), size = case_smp)
casetrain <- df.case[train_ind2, ]
casetest <- df.case[-train_ind2, ]
# Logistic Regression, Mobility
lr.mob <- glm(label_Mobility ~ confirmed_infections + rt + days0 + days1 + days2 +
days3 + days4 + days5 + days6, family = binomial, data = mobtrain)
summary(lr.mob)
# test the mobility logistic regression
predicted_probs<-predict(lr.mob,mobtest,type="response")
predicted<-predicted_probs>0.5
predicted<-as.numeric(predicted)
confusion_matrix <- table(mobtest$label_Mobility, predicted, dnn = c("Actual", "Predicted"))
confusion_matrix
total<-length(mobtest$label_Mobility) #get the count of all
accuracy<- (confusion_matrix[1,1]+confusion_matrix[2,2])/total
accuracy*100
# logistic regresssion, infections
lr.case <- glm(label_confirmed_infections ~ Mobility + rt + days0 + days1 + days2 +
days3 + days4 + days5 + days6, family = binomial, data = casetrain)
summary(lr.case)
# test the  infection logistic regression
predicted_probs<-predict(lr.case,casetest,type="response")
predicted<-predicted_probs>0.5
predicted<-as.numeric(predicted)
confusion_matrix <- table(casetest$label_confirmed_infections, predicted, dnn = c("Actual", "Predicted"))
confusion_matrix
total<-length(casetest$label_confirmed_infections) #get the count of all
accuracy<- (confusion_matrix[1,1]+confusion_matrix[2,2])/total
accuracy*100
#**************************************************
#LDA, mobility
lda.mob <-lda(label_Mobility ~ confirmed_infections + rt + days0 + days1 + days2 +
days3 + days4 + days5 + days6,data=mobtrain)
#summary(lda.mob)
lda_predicted <- predict(lda.mob,mobtest)
lda_label =lda_predicted$class
table(mobtest$label_Mobility,lda_label,dnn = c("Actual", "Predicted"))
#test of mobility LDA
accuracy_lda_test <- mean(lda_label==mobtest$label_Mobility)
accuracy_lda_test*100
#LDA, infections
lda.case <-lda(label_confirmed_infections ~ Mobility + rt + days0 + days1 + days2 +
days3 + days4 + days5 + days6,data=casetrain)
lda_predicted <- predict(lda.case,casetest)
lda_label =lda_predicted$class
table(casetest$label_confirmed_infections,lda_label,dnn = c("Actual", "Predicted"))
#test of infection  LDA
accuracy_lda_test <- mean(lda_label==casetest$label_confirmed_infections)
accuracy_lda_test*100
#svm, mobility
svm_case <-svm(label_Mobility ~ confirmed_infections + rt + days0 + days1 + days2 +
days3 + days4 + days5 + days6,data=casetrain)
summary(svm_case)
svm_predicted_probs <- predict(svm_case,casetest)
svm_predicted<-svm_predicted_probs>0.5
svm_predicted<-as.numeric(svm_predicted)
confusion_matrix <- table(casetest$label_Mobility, svm_predicted, dnn = c("Actual", "Predicted"))
confusion_matrix
total<-length(casetest$label_Mobility) #get the count of all
accuracy<- (confusion_matrix[1,1]+confusion_matrix[2,2])/total
accuracy*100
#svm, confirmed infections
svm_case <-svm(label_confirmed_infections ~ Mobility + rt + days0 + days1 + days2 +
days3 + days4 + days5 + days6,data=casetrain)
summary(svm_case)
svm_predicted_probs <- predict(svm_case,casetest)
svm_predicted<-svm_predicted_probs>0.5
svm_predicted<-as.numeric(svm_predicted)
confusion_matrix <- table(casetest$label_confirmed_infections, svm_predicted, dnn = c("Actual", "Predicted"))
confusion_matrix
total<-length(casetest$label_confirmed_infections) #get the count of all
accuracy<- (confusion_matrix[1,1]+confusion_matrix[2,2])/total
accuracy*100
#boosting, mobility
boost_model <- gbm(label_Mobility ~ confirmed_infections + rt + days0 + days1 + days2 +
days3 + days4 + days5 + days6,data=casetrain, distribution = "bernoulli", n.trees = 1000)
predicted_prob_boost <- predict(boost_model, newdata = casetest, n.trees = 1000)
predicted_label_boost <- ifelse(predicted_prob_boost > 0.5, 1, 0)
confusion_matrix <- table(casetest$label_Mobility, predicted_label_boost)
total<-length(casetest$label_Mobility) #get the count of all
accuracy<- (confusion_matrix[1,1]+confusion_matrix[2,2])/total
accuracy*100
#boosting, infections
boost_model <- gbm(label_confirmed_infections ~ Mobility + rt + days0 + days1 + days2 +
days3 + days4 + days5 + days6,data=casetrain, distribution = "bernoulli", n.trees = 1000)
predicted_prob_boost <- predict(boost_model, newdata = casetest, n.trees = 1000)
predicted_label_boost <- ifelse(predicted_prob_boost > 0.5, 1, 0)
confusion_matrix <- table(casetest$label_confirmed_infections, predicted_label_boost)
total<-length(casetest$label_confirmed_infections) #get the count of all
accuracy<- (confusion_matrix[1,1]+confusion_matrix[2,2])/total
accuracy*100
#load libraries
library(MASS)
library(tidyverse)
library(e1071)
library(tree)
library(gbm)
#LOAD DATA
df.mob <- read_csv("https://raw.githubusercontent.com/mp5782/2338-Project/main/data/mobility_class.csv")
mob_smp <- floor(0.75 * nrow(df.mob))
df.case <- read_csv("https://raw.githubusercontent.com/mp5782/2338-Project/main/data/infection_class.csv")
case_smp <- floor(0.75 * nrow(df.case))
## mobility data split
set.seed(123)
train_ind1 <- sample(seq_len(nrow(df.mob)), size = mob_smp)
mobtrain <- df.mob[train_ind1, ]
mobtest <- df.mob[-train_ind1, ]
## case data split
set.seed(123)
train_ind2 <- sample(seq_len(nrow(df.case)), size = case_smp)
casetrain <- df.case[train_ind2, ]
casetest <- df.case[-train_ind2, ]
# Logistic Regression, Mobility
lr.mob <- glm(label_Mobility ~ confirmed_infections + rt + days0 + days1 + days2 +
days3 + days4 + days5 + days6, family = binomial, data = mobtrain)
summary(lr.mob)
# test the mobility logistic regression
predicted_probs<-predict(lr.mob,mobtest,type="response")
predicted<-predicted_probs>0.5
predicted<-as.numeric(predicted)
confusion_matrix <- table(mobtest$label_Mobility, predicted, dnn = c("Actual", "Predicted"))
confusion_matrix
total<-length(mobtest$label_Mobility) #get the count of all
accuracy<- (confusion_matrix[1,1]+confusion_matrix[2,2])/total
accuracy*100
# logistic regresssion, infections
lr.case <- glm(label_confirmed_infections ~ Mobility + rt + days0 + days1 + days2 +
days3 + days4 + days5 + days6, family = binomial, data = casetrain)
summary(lr.case)
# test the  infection logistic regression
predicted_probs<-predict(lr.case,casetest,type="response")
predicted<-predicted_probs>0.5
predicted<-as.numeric(predicted)
confusion_matrix <- table(casetest$label_confirmed_infections, predicted, dnn = c("Actual", "Predicted"))
confusion_matrix
total<-length(casetest$label_confirmed_infections) #get the count of all
accuracy<- (confusion_matrix[1,1]+confusion_matrix[2,2])/total
accuracy*100
#**************************************************
#LDA, mobility
lda.mob <-lda(label_Mobility ~ confirmed_infections + rt + days0 + days1 + days2 +
days3 + days4 + days5 + days6,data=mobtrain)
#summary(lda.mob)
lda_predicted <- predict(lda.mob,mobtest)
lda_label =lda_predicted$class
table(mobtest$label_Mobility,lda_label,dnn = c("Actual", "Predicted"))
#test of mobility LDA
accuracy_lda_test <- mean(lda_label==mobtest$label_Mobility)
accuracy_lda_test*100
#LDA, infections
lda.case <-lda(label_confirmed_infections ~ Mobility + rt + days0 + days1 + days2 +
days3 + days4 + days5 + days6,data=casetrain)
lda_predicted <- predict(lda.case,casetest)
lda_label =lda_predicted$class
table(casetest$label_confirmed_infections,lda_label,dnn = c("Actual", "Predicted"))
#test of infection  LDA
accuracy_lda_test <- mean(lda_label==casetest$label_confirmed_infections)
accuracy_lda_test*100
#svm, mobility
svm_case <-svm(label_Mobility ~ confirmed_infections + rt + days0 + days1 + days2 +
days3 + days4 + days5 + days6,data=casetrain)
summary(svm_case)
svm_predicted_probs <- predict(svm_case,casetest)
svm_predicted<-svm_predicted_probs>0.5
svm_predicted<-as.numeric(svm_predicted)
confusion_matrix <- table(casetest$label_Mobility, svm_predicted, dnn = c("Actual", "Predicted"))
confusion_matrix
total<-length(casetest$label_Mobility) #get the count of all
accuracy<- (confusion_matrix[1,1]+confusion_matrix[2,2])/total
accuracy*100
#svm, confirmed infections
svm_case <-svm(label_confirmed_infections ~ Mobility + rt + days0 + days1 + days2 +
days3 + days4 + days5 + days6,data=casetrain)
summary(svm_case)
svm_predicted_probs <- predict(svm_case,casetest)
svm_predicted<-svm_predicted_probs>0.5
svm_predicted<-as.numeric(svm_predicted)
confusion_matrix <- table(casetest$label_confirmed_infections, svm_predicted, dnn = c("Actual", "Predicted"))
confusion_matrix
total<-length(casetest$label_confirmed_infections) #get the count of all
accuracy<- (confusion_matrix[1,1]+confusion_matrix[2,2])/total
accuracy*100
